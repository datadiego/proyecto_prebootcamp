<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Guia servidor web Apache</title>
	<style>
	* {
	font-family: monospace;
	font-size: 18px;
	}

	code {
	background: black;
	color: white;
	}
	</style>
</head>
<body>
<h1>Guia de creación pagina web</h1>

<p>Utilizaremos Ubuntu junto a Apache2 para levantar un servidor que procesará las solicitudes http y enviará los archivos html correspondientes.</p>

<h2>Creación de máquina virtual</h2>
<p>Descarga la imagen de <a href="https://ubuntu.com/download">Ubuntu</a> en la pagina oficial, en este ejemplo utilizaremos la version 23.10.1</p>
<p>Descarga <a href="https://www.virtualbox.org/">VirtualBox</a> de la página oficial, instalalo y crea una nueva maquina virtual con la imagen que descargaste.</p>
<p>Debemos asegurarnos de varias cosas en la configuración:</p>
<ul>
    <li>En Settings > Network debemos usar el "Adaptador puente" como adaptador de red</li>
    <li>Debemos dar al menos 4 nucleos, de lo contrario el proceso puede ser muy largo</li>
    <li>Daremos al menos 20GB de memoria</li>
</ul>

<p>Una vez Ubuntu está correctamente instalado, procedemos a su configuración</p>

<h2>Configuración básica Ubuntu</h2>
<p>Antes de empezar, actualiza tu sistema con <code>sudo apt update sudo apt upgrade</code></p>
<p>Instala net-tools con <code>sudo apt install net-tools</code></p>

<h3>Establecer IP estatica</h3>
<p>Para evitar que nuestra maquina cambie de IP, seguimos los siguientes pasos</p>

<ul>
    <li>Vamos a Settings > Network</li>
    <li>En la seccion "Wired" hacemos click en el icono de configuracion</li>
    <li>En la pestaña IPv4, seleccionamos el método "Manual"</li>
    <li>En la seccion "Address" puedes configurar tu dirección IP, asegúrate de no tener otro dispositivo con la misma IP en tu red</li>
    <li>Haz <code>ifconfig</code> o <code>ipconfig</code> segun tu sistema para obtener tu mascara de red y puerta de enlace predeterminada</li>
    <li>En la sección "Netmask" introduce tu máscara de red</li>
    <li>En la sección "Gateway", introduce tu puerta de enlace</li>
    <li>Selecciona el modo manual en la sección "DNS", introduce 1.1.1.1, 8.8.8.8</li>
    <li>Comprueba que tienes conexión a internet haciendo ping</li>
</ul>

<h3>Configurar SSH</h3>
<p>Vamos a configurar un servidor SSH que nos permita conectarnos a la maquina de forma remota</p>
<ul>
    <li>Actualiza tu sistema operativo con <code>sudo apt update sudo apt upgrade</code></li>
    <li>Descarga OpenSSH <code>sudo apt install openssh-server</code></li>
    <li>Puedes comprobar el estado del servicio con <code>sudo systemctl status ssh</code></li>
    <li>Puedes iniciar el servicio con <code>sudo systemctl start ssh</code></li>
    <li>Puedes hacer que el servicio se inicie siempre al iniciar la maquina con <code>sudo systemctl enable ssh</code></li>
    <li>Para entrar desde otro dispositivo, hazlo con <code>ssh usuario@ip</code></li>
</ul>

<h3>Configurar FTP</h3>
<p>Vamos a configurar un servidor FTP que nos deje enviar ficheros entre maquinas</p>

<ul>
    <li>Descarga el servidor vsftpd con <code>sudo apt install vsftpd</code></li>
    <li>Configura el servidor con nano <code>sudo nano /etc/vsftpd.conf</code></li>
    <li>Asegurate de cambiar los siguientes parametros:
	<p>local_enable=YES</p>
	<p>write_enable=YES</p>
	<p>connect_from_port_20=YES</p>
    </li>
    <li>Puedes comprobar el estado con <code>sudo systemctl status vsftpd</code></li>
    <li>Puedes lanzar el servicio con <code>sudo systemctl start vsftpd</code></li>
    <li>Puedes hacer que el servicio se inicie al iniciar la maquina con <code>sudo systemctl enable vsftpd</code></li>
</ul>

<p>Para utilizarlo necesitarás usar un cliente FTP como <a href="https://filezilla-project.org/">Filezilla</a>, indicar tu nombre de usuario, IP y contraseña. </p>

<h3>Configurar Apache2</h3>
<p>Apache2 se encarga de servir nuestros documentos HTML, para instalarlo y configurarlo haremos lo siguiente:</p>
<ul>
    <li>Instalamos el servicio con <code>sudo apt install apache2</code></li>
    <li>Podemos comprobar el estado del servicio con <code>sudo systemctl status apache2</code></li>
    <li>Podemos configurar el firewall para permitir el servicio <code>sudo ufw allow 'Apache'</code></li>
    <li>Comprueba que tu página web está operativa entrando en tu ip desde el navegador o en localhost</li>
    <li>Para editar la página, puedes editar el archivo <code>index.html</code> situado en <code>/var/www/html</code></li>
    <li>Puedes visitar tu página visitando tu IP directamente en el navegador</li>
</ul>


<h3>Editar archivo host</h3>

<p>Si quieres poder acceder a la web desde un dominio en lugar de su IP, deberás editar el archivo de host de tu sistema</p>
<p>En Ubuntu, el archivo está en <code>/etc/hosts</code>, puedes editarlo mediante <code>sudo nano /etc/hosts</code></p>
<p>En Windows, el archivo está en <code>C:\Windows\System32\drivers\etc\hosts</code>, puedes editarlo en el bloc de notas, aunque tendrás que editarlo fuera de la carpeta original.</p>
<p>Deberás editar el archivo hosts siguiendo el siguiente ejemplo:</p>
<p>192.168.0.30	nombre-de-tu-web.com</p>

<h3>Añadir certificado SSL</h3>
<p>Para poder añadir un certificado SSL a nuestra web podemos utilizar certbot.</p>

<ul>
    <li>Para instalarlo, ejecuta <code>sudo apt install certbot python3-certbot-apache</code></li>
    <li>Permite que el firewall habilite el HTTPS <code>sudo ufw allow https</code></li>
    <li>Obtener el certificado es fácil, ejecuta <code>sudo certbot --apache</code> y sigue las instrucciones.</li>
    <li>Automatiza la renovación del certificado <code>sudo crontab -e</code></li>
    <li>Añade la siguiente linea: <code>0 */12 * * * /usr/bin/certbot renew --quiet</code></li>
</ul>
</body>

</html>
